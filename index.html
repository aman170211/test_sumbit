<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MTurk HIT Example</title>
  <!-- No external dependencies; using JavaScript to handle MTurk parameters -->
</head>
<body>
  <!-- Mechanical Turk External HIT Form -->
  <form id="mturk_form" method="POST" action="https://www.mturk.com/mturk/externalSubmit">
    <!-- Hidden field for the assignment ID (filled in by JavaScript) -->
    <input type="hidden" name="assignmentId" id="assignmentId" value="">

    <!-- Text input for worker's answer -->
    <p>
      <label for="answer">Enter your answer:</label>
      <input type="text" name="answer" id="answer" />
    </p>

    <!-- Submit button -->
    <p>
      <input type="submit" id="submitButton" value="Submit" />
    </p>
  </form>

  <!-- JavaScript to handle assignmentId and submission URL -->
  <script type="text/javascript">
    (function() {
      // Parse URL parameters
      var params = new URLSearchParams(window.location.search);
      var assignmentId = params.get("assignmentId");
      var turkSubmitTo = params.get("turkSubmitTo");

      // If HIT is not yet accepted (preview mode), disable the submit button
      if (!assignmentId || assignmentId === "ASSIGNMENT_ID_NOT_AVAILABLE") {
        document.getElementById("submitButton").disabled = true;
      } else {
        // If assignmentId is provided, insert it into the hidden field
        document.getElementById("assignmentId").value = assignmentId;
      }

      // Set the form's action to the correct endpoint (sandbox vs. production)
      if (turkSubmitTo) {
        // Remove any trailing slash from turkSubmitTo
        if (turkSubmitTo.endsWith("/")) {
          turkSubmitTo = turkSubmitTo.slice(0, -1);
        }
        document.getElementById("mturk_form").action = turkSubmitTo + "/mturk/externalSubmit";
      }
    })();
  </script>
</body>
</html>
