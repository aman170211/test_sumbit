<!DOCTYPE html>
<html>
<head>
  <title>MTurk Submission</title>
</head>
<body>
  <h2>Enter your answer</h2>

  <input type="text" id="userAnswer" placeholder="Type your answer here" required />

  <br><br>
  <button onclick="submitToMTurk()">Submit</button>

  <script>
    function submitToMTurk() {
      const urlParams = new URLSearchParams(window.location.search);
      const assignmentId = urlParams.get("assignmentId");
      const answer = document.getElementById("userAnswer").value;

      if (!assignmentId || assignmentId === "ASSIGNMENT_ID_NOT_AVAILABLE") {
        alert("Please accept the HIT before submitting.");
        return;
      }

      if (!answer.trim()) {
        alert("Please enter an answer before submitting.");
        return;
      }

      // Create the form
      const form = document.createElement("form");
      form.method = "POST";
      form.action = window.location.hostname.includes("workersandbox")
        ? "https://workersandbox.mturk.com/mturk/externalSubmit"
        : "https://www.mturk.com/mturk/externalSubmit";

      // assignmentId
      const inputAssignmentId = document.createElement("input");
      inputAssignmentId.type = "hidden";
      inputAssignmentId.name = "assignmentId";
      inputAssignmentId.value = assignmentId;
      form.appendChild(inputAssignmentId);

      // answer
      const inputAnswer = document.createElement("input");
      inputAnswer.type = "hidden";
      inputAnswer.name = "answer";
      inputAnswer.value = answer;
      form.appendChild(inputAnswer);

      // submit flag (optional but good practice)
      const inputSubmit = document.createElement("input");
      inputSubmit.type = "hidden";
      inputSubmit.name = "submit";
      inputSubmit.value = "Submit";
      form.appendChild(inputSubmit);

      document.body.appendChild(form);
      form.submit();
    }
  </script>
</body>
</html>
